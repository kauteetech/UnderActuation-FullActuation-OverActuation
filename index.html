<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Robot Actuation & Order Animation with Math</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #f0f0f0;
            margin: 20px;
        }
        h1 {
            color: #333;
        }
        .concept-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 30px;
            margin-top: 30px;
        }
        .scenario {
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            padding: 20px;
            text-align: center;
            width: 350px; /* Wider to accommodate formulas */
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            justify-content: space-between; /* Space out content */
        }
        .scenario h2 {
            color: #0056b3;
            margin-top: 0;
            font-size: 1.3em;
        }
        .animation-area {
            width: 330px; /* Adjusted width */
            height: 150px;
            border: 2px solid #ccc;
            margin: 15px auto;
            position: relative;
            overflow: hidden;
            background-color: #e9e9e9;
        }
        .robot {
            position: absolute;
            width: 30px;
            height: 30px;
            background-color: #ff5733;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.8em;
            font-weight: bold;
            top: 60px; /* Start in the middle vertically */
            left: 10px;
        }
        .robot.underactuated {
            background-color: #33aaff; /* Blue for underactuated */
        }
        .robot.overactuated {
            background-color: #5cb85c; /* Green for overactuated */
        }
        .robot.fully-actuated {
            background-color: #f0ad4e; /* Orange for fully actuated */
        }
        .robot.first-order {
            background-color: #6a05ad; /* Purple for first order */
        }
        .robot.second-order {
            background-color: #d9534f; /* Red for second order */
        }
        p {
            font-size: 0.9em;
            color: #555;
            flex-grow: 1; /* Allow description to take available space */
            margin-bottom: 10px; /* Space before formulas */
        }
        .math-formula {
            font-family: serif; /* MathJax default font usually serif */
            margin: 10px 0;
            color: #333;
            font-size: 1.1em;
            border-top: 1px dashed #eee;
            padding-top: 10px;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            margin-top: auto; /* Push button to bottom */
        }
        button:hover {
            background-color: #0056b3;
        }
        .target {
            position: absolute;
            top: 60px;
            right: 10px;
            width: 30px;
            height: 30px;
            border: 2px dashed #007bff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #007bff;
            font-size: 0.8em;
        }
    </style>
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            },
            svg: {
                fontCache: 'global'
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
    <h1>Robot Actuation & Order Concepts</h1>
    <p>Watch how the 'robot' moves to illustrate different concepts. **(Requires internet connection for formulas)**</p>

    <div class="concept-container">

        <div class="scenario">
            <h2>First Order System</h2>
            <div class="animation-area">
                <div class="robot first-order" id="robot1">1st</div>
                <div class="target">T</div>
            </div>
            <p>
                In a **first-order system**, the output's rate of change is directly proportional to the difference between its current state and the desired state. It moves smoothly towards the target without oscillation.
            </p>
            <div class="math-formula">
                **Equation:** $ \tau \frac{dy(t)}{dt} + y(t) = K u(t) $
                <br>
                **Simplified for Velocity:** $ F = b \cdot v $
                <br>
                *Where:*
                <br>
                $F$: Force, $b$: Damping coefficient, $v$: Velocity
            </div>
            <button onclick="startAnimation('robot1', 'firstOrder')">Start 1st Order</button>
        </div>

        <div class="scenario">
            <h2>Second Order System</h2>
            <div class="animation-area">
                <div class="robot second-order" id="robot2">2nd</div>
                <div class="target">T</div>
            </div>
            <p>
                A **second-order system** involves acceleration (rate of change of velocity). Its response can oscillate and overshoot before settling, depending on its damping characteristics. Most rigid-body robots exhibit second-order dynamics.
            </p>
            <div class="math-formula">
                **Equation:** $ m \frac{d^2x}{dt^2} + b \frac{dx}{dt} + kx = F $
                <br>
                **Newton's Second Law:** $ F = m \cdot a $
                <br>
                *Where:*
                <br>
                $F$: Force, $m$: Mass, $a$: Acceleration, $b$: Damping, $k$: Stiffness
            </div>
            <button onclick="startAnimation('robot2', 'secondOrder')">Start 2nd Order</button>
        </div>

        <div class="scenario">
            <h2>Fully Actuated</h2>
            <div class="animation-area">
                <div class="robot fully-actuated" id="robot3">Full</div>
                <div class="target">T</div>
            </div>
            <p>
                A **fully actuated** system has an equal number of independent **actuators** ($n_a$) as its degrees of freedom ($n_{DoF}$). This provides direct control over every possible motion.
            </p>
            <div class="math-formula">
                **Condition:** $ n_a = n_{DoF} $
                <br>
                **Control Input:** $ \tau = I \ddot{q} + C(\dot{q}, q) \dot{q} + G(q) $
                <br>
                *Where:*
                <br>
                $\tau$: Actuator torques/forces, $I$: Inertia matrix, $q$: Joint angles/positions
            </div>
            <button onclick="startAnimation('robot3', 'fullyActuated')">Start Fully Actuated</button>
        </div>

        <div class="scenario">
            <h2>Underactuated</h2>
            <div class="animation-area">
                <div class="robot underactuated" id="robot4">Under</div>
                <div class="target">T</div>
            </div>
            <p>
                An **underactuated** system has fewer independent **actuators** ($n_a$) than its degrees of freedom ($n_{DoF}$). Control requires exploiting system dynamics to move unactuated DoFs (e.g., a bicycle balancing).
            </p>
            <div class="math-formula">
                **Condition:** $ n_a < n_{DoF} $
                <br>
                **Dynamic Coupling:** Control inputs affect both actuated and unactuated DoFs.
            </div>
            <button onclick="startAnimation('robot4', 'underactuated')">Start Underactuated</button>
        </div>

        <div class="scenario">
            <h2>Overactuated</h2>
            <div class="animation-area">
                <div class="robot overactuated" id="robot5">Over</div>
                <div class="target">T</div>
            </div>
            <p>
                An **overactuated** system has more independent **actuators** ($n_a$) than its degrees of freedom ($n_{DoF}$). This provides redundancy, improving fault tolerance and allowing for optimized performance.
            </p>
            <div class="math-formula">
                **Condition:** $ n_a > n_{DoF} $
                <br>
                **Redundancy Resolution:**
                <br>
                Minimize $ J = \tau^T W \tau $ subject to $ J\tau = \dot{x} $
            </div>
            <button onclick="startAnimation('robot5', 'overactuated')">Start Overactuated</button>
        </div>

    </div>

    <script>
        const targetX = 290; // Target X position for the robot (right side of animation area)
        const startX = 10;   // Starting X position for the robot (left side)

        function resetRobot(robotId) {
            const robot = document.getElementById(robotId);
            robot.style.left = startX + 'px';
            robot.style.top = '60px'; // Reset vertical position
            robot.style.transition = 'none'; // Clear any ongoing transitions
            robot.style.transform = 'none'; // Clear any ongoing transforms
            void robot.offsetWidth; // Trigger reflow to apply transition:none immediately
        }

        function startAnimation(robotId, type) {
            resetRobot(robotId); // Reset position before starting
            const robot = document.getElementById(robotId);
            
            // A small delay is needed after changing style.transition to 'none' and before setting new transition
            setTimeout(() => {
                switch (type) {
                    case 'firstOrder':
                        robot.style.transition = 'left 3s ease-out';
                        robot.style.left = targetX + 'px';
                        break;
                    case 'secondOrder':
                        robot.style.transition = 'left 3s cubic-bezier(0.68, -0.55, 0.265, 1.55)'; /* Spring-like */
                        robot.style.left = targetX + 'px';
                        break;
                    case 'fullyActuated':
                        robot.style.transition = 'left 2s linear';
                        robot.style.left = targetX + 'px';
                        break;
                    case 'underactuated':
                        robot.style.transition = 'all 4s ease-in-out';
                        // Simulate a swing-up path (move down, then up, then right)
                        robot.style.transform = 'translate(0px, 30px)'; // Down slightly
                        setTimeout(() => {
                            robot.style.transform = `translate(${targetX - startX}px, -30px)`; // Up and right
                            setTimeout(() => {
                                robot.style.transform = `translate(${targetX - startX}px, 0px)`; // Settle at target height
                                robot.style.left = targetX + 'px'; // Final position update
                                robot.style.top = '60px';
                                robot.style.transform = 'none'; // Clear transform
                            }, 1500); // Time for the up-and-right swing
                        }, 500); // Time for the initial downward motion
                        break;
                    case 'overactuated':
                        robot.style.transition = 'left 4s linear'; // Initial slow movement
                        robot.style.left = targetX + 'px';

                        // Simulate a "backup" actuator kicking in halfway
                        setTimeout(() => {
                            // Check if the robot has reached the target yet
                            const currentLeft = parseFloat(robot.style.left);
                            if (currentLeft < targetX - 5) { // If not very close to target
                                robot.style.transition = 'left 0.5s ease-out'; // Faster finish
                                robot.style.left = targetX + 'px';
                            }
                        }, 2000); // After 2 seconds, give a "redundant push"
                        break;
                }
            }, 50); // Small delay to ensure reset applies
        }
    </script>
</body>
</html>
